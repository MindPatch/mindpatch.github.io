<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Legacy SDK Flaws Cause Stored XSS and Account Takeover | @MindPatch</title><meta name=keywords content="XSS,Account Takeover,SDK,Bug Bounty"><meta name=description content="
—
Alright, let me tell you a fun story about how a casual day of hunting bugs turned into a serious jackpot — all thanks to some forgotten open source library!
It started like any other day: coffee ready, Burp Suite fired up, and enthusiasm maxed out. I was testing a cool AI-driven reporting/training platform over at example.ai.
These folks were pretty solid when it came to securing their main endpoints; my usual payloads and tests didn’t reveal much initially. However, the moment I stumbled onto their  /reports  page, my curiosity went through the roof. This page was super interactive—it allowed users to create detailed, professional-looking reports with graphs, charts, images, markdown support, etc .."><meta name=author content="MindPatch"><link rel=canonical href=https://www.mindpatch.net/posts/legacy-sdk-xss-account-takeover/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://www.mindpatch.net/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.mindpatch.net/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.mindpatch.net/favicon-32x32.png><link rel=apple-touch-icon href=https://www.mindpatch.net/apple-touch-icon.png><link rel=mask-icon href=https://www.mindpatch.net/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.mindpatch.net/posts/legacy-sdk-xss-account-takeover/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://www.mindpatch.net/posts/legacy-sdk-xss-account-takeover/"><meta property="og:site_name" content="@MindPatch"><meta property="og:title" content="Legacy SDK Flaws Cause Stored XSS and Account Takeover"><meta property="og:description" content="
—
Alright, let me tell you a fun story about how a casual day of hunting bugs turned into a serious jackpot — all thanks to some forgotten open source library!
It started like any other day: coffee ready, Burp Suite fired up, and enthusiasm maxed out. I was testing a cool AI-driven reporting/training platform over at example.ai.
These folks were pretty solid when it came to securing their main endpoints; my usual payloads and tests didn’t reveal much initially. However, the moment I stumbled onto their /reports page, my curiosity went through the roof. This page was super interactive—it allowed users to create detailed, professional-looking reports with graphs, charts, images, markdown support, etc .."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-14T00:00:00+00:00"><meta property="article:modified_time" content="2025-03-14T00:00:00+00:00"><meta property="article:tag" content="XSS"><meta property="article:tag" content="Account Takeover"><meta property="article:tag" content="SDK"><meta property="article:tag" content="Bug Bounty"><meta property="og:image" content="https://www.mindpatch.net/og-image.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.mindpatch.net/og-image.png"><meta name=twitter:title content="Legacy SDK Flaws Cause Stored XSS and Account Takeover"><meta name=twitter:description content="
—
Alright, let me tell you a fun story about how a casual day of hunting bugs turned into a serious jackpot — all thanks to some forgotten open source library!
It started like any other day: coffee ready, Burp Suite fired up, and enthusiasm maxed out. I was testing a cool AI-driven reporting/training platform over at example.ai.
These folks were pretty solid when it came to securing their main endpoints; my usual payloads and tests didn’t reveal much initially. However, the moment I stumbled onto their  /reports  page, my curiosity went through the roof. This page was super interactive—it allowed users to create detailed, professional-looking reports with graphs, charts, images, markdown support, etc .."><meta name=twitter:site content="@https://twitter.com/mindpatch"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.mindpatch.net/posts/"},{"@type":"ListItem","position":2,"name":"Legacy SDK Flaws Cause Stored XSS and Account Takeover","item":"https://www.mindpatch.net/posts/legacy-sdk-xss-account-takeover/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Legacy SDK Flaws Cause Stored XSS and Account Takeover","name":"Legacy SDK Flaws Cause Stored XSS and Account Takeover","description":"\n—\nAlright, let me tell you a fun story about how a casual day of hunting bugs turned into a serious jackpot — all thanks to some forgotten open source library!\nIt started like any other day: coffee ready, Burp Suite fired up, and enthusiasm maxed out. I was testing a cool AI-driven reporting/training platform over at example.ai.\nThese folks were pretty solid when it came to securing their main endpoints; my usual payloads and tests didn’t reveal much initially. However, the moment I stumbled onto their /reports page, my curiosity went through the roof. This page was super interactive—it allowed users to create detailed, professional-looking reports with graphs, charts, images, markdown support, etc ..\n","keywords":["XSS","Account Takeover","SDK","Bug Bounty"],"articleBody":"\n—\nAlright, let me tell you a fun story about how a casual day of hunting bugs turned into a serious jackpot — all thanks to some forgotten open source library!\nIt started like any other day: coffee ready, Burp Suite fired up, and enthusiasm maxed out. I was testing a cool AI-driven reporting/training platform over at example.ai.\nThese folks were pretty solid when it came to securing their main endpoints; my usual payloads and tests didn’t reveal much initially. However, the moment I stumbled onto their /reports page, my curiosity went through the roof. This page was super interactive—it allowed users to create detailed, professional-looking reports with graphs, charts, images, markdown support, etc ..\nI tried finding any bugs on this feature but didn’t ended well unfortunately\nBut after searching around their github organization repos I found a library called utils_libs and its README.md says that let you create report using python in automated way\nand I revealed two versions of their report library: utils.report.v1 and utils_libs.report.v2. Considering organizations often neglect older SDK versions during updates, I wondered whether the older v1 endpoint might still be active\nCuriosity piqued, I quickly whipped up a test script using the old, seemingly abandoned v1 API:\nimport utils_libs import utils_libs.reports.v1 as ul # Setup credentials entity = \"\" project = \"\"# Creating a sneaky report report = ul.Report( entity=entity, project=project, title=\"XSS HERE BE AWARE\", description=\"Never gonna give you up, never gonna let you down\" )# Injecting our little surprise report.save() after running the script I got the report created on the UI successfully.\nI add burpsuite in the mid of the library requests to track it down and I noticed it calls different endpoints!\nWhen using this endpoint, there is no XSS (Cross-Site Scripting) filter applied to functions that are intended to add links for the report writer. Below is an example of how this vulnerability can be exploited:\nimport utils_libs import utils_libs.reports.v1 as ul # Initialize the utils_libs API api = utils_libs.Api()# Define the entity and project entity = \"\" # Replace with your utils_libs entity project = \"\" # Replace with your utils_libs project# Create a new report report = ul.Report( entity=entity, project=project, title=\"XSS HERE - BE AWARE\", description=\"Never gonna give you up, never gonna let you down\" )# Add a block with an XSS payload report.blocks = [ul.Twitter('\"\u003e')]# Save the report report.save() This code successfully stored an XSS payload, which can be accessed via the URL example.ai/reports/. Notably, this report can be viewed by anyone, even if they are not part of my organization\nBut wait, there’s more! After the excitement of the first payout wore off, I thought, “why not dig a bit deeper?”\nRevisiting their repository, I found another interesting feature — embedding videos into reports. Now, embedding videos seemed innocent enough, but experience taught me never to underestimate innocent-looking functionalities.\nSo, I gave it a try:\nreport = ul.Report( entity=entity, project=project, title=\"Another Sneaky XSS\", description=\"Keep calm and hack responsibly\" ) report.pages = [ul.Video('javascript:alert()')] report.save() And bingo! Another stored XSS! But this wasn’t just any simple vulnerability — this time, it was even more impactful.\nBy chaining this XSS with another minor misconfiguration, I escalated it to full account takeover.\nThat meant I could completely control someone’s account just by tricking them into viewing my crafted report.\nThe team this time higher the impact and higher the bounty which is a good win\nSide Hint: Always dig deeper into seemingly unrelated or forgotten resources. Old API docs, outdated Python SDKs, archived repositories, or forgotten JavaScript files might contain hidden parameters or endpoints. These endpoints often bypass filters or security checks because they aren’t actively maintained, potentially leading to undiscovered vulnerabilities.\nAnd that’s it\nBye ..\n","wordCount":"618","inLanguage":"en","image":"https://www.mindpatch.net/og-image.png","datePublished":"2025-03-14T00:00:00Z","dateModified":"2025-03-14T00:00:00Z","author":{"@type":"Person","name":"MindPatch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.mindpatch.net/posts/legacy-sdk-xss-account-takeover/"},"publisher":{"@type":"Organization","name":"@MindPatch","logo":{"@type":"ImageObject","url":"https://www.mindpatch.net/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.mindpatch.net/ accesskey=h title="@MindPatch (Alt + H)">@MindPatch</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.mindpatch.net/about title=About><span>About</span></a></li><li><a href=https://www.mindpatch.net/projects/ title=Projects><span>Projects</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Legacy SDK Flaws Cause Stored XSS and Account Takeover</h1><div class=post-meta><span title='2025-03-14 00:00:00 +0000 UTC'>March 14, 2025</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;MindPatch</div></header><div class=post-content><p><img loading=lazy src=https://miro.medium.com/v2/resize:fit:480/0*wFXpWUgkd4CNm-ov.gif></p><p>—</p><p>Alright, let me tell you a fun story about how a casual day of hunting bugs turned into a serious jackpot — all thanks to some forgotten open source library!</p><p>It started like any other day: coffee ready, Burp Suite fired up, and enthusiasm maxed out. I was testing a cool AI-driven reporting/training platform over at example.ai.</p><p>These folks were pretty solid when it came to securing their main endpoints; my usual payloads and tests didn’t reveal much initially. However, the moment I stumbled onto their <code>/reports</code> page, my curiosity went through the roof. This page was super interactive—it allowed users to create detailed, professional-looking reports with graphs, charts, images, markdown support, etc ..</p><p>I tried finding any bugs on this feature but didn’t ended well unfortunately</p><p>But after searching around their github organization repos I found a library called <code>utils_libs</code> and its README.md says that let you create report using python in automated way</p><p>and I revealed two versions of their report library: <code>utils.report.v1</code> and <code>utils_libs.report.v2</code>. Considering organizations often neglect older SDK versions during updates, I wondered whether the older <code>v1</code> endpoint might still be active</p><p>Curiosity piqued, I quickly whipped up a test script using the old, seemingly abandoned <code>v1</code> API:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> utils_libs  
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> utils_libs.reports.v1 <span style=color:#66d9ef>as</span> ul
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Setup credentials  </span>
</span></span><span style=display:flex><span>entity <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;REPLACE&gt;&#34;</span>  
</span></span><span style=display:flex><span>project <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;REPLACE&gt;&#34;</span><span style=color:#75715e># Creating a sneaky report  </span>
</span></span><span style=display:flex><span>report <span style=color:#f92672>=</span> ul<span style=color:#f92672>.</span>Report(  
</span></span><span style=display:flex><span>    entity<span style=color:#f92672>=</span>entity,  
</span></span><span style=display:flex><span>    project<span style=color:#f92672>=</span>project,  
</span></span><span style=display:flex><span>    title<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;XSS HERE BE AWARE&#34;</span>,  
</span></span><span style=display:flex><span>    description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Never gonna give you up, never gonna let you down&#34;</span>  
</span></span><span style=display:flex><span>)<span style=color:#75715e># Injecting our little surprise  </span>
</span></span><span style=display:flex><span>report<span style=color:#f92672>.</span>save()
</span></span></code></pre></div><p>after running the script I got the report created on the UI successfully.</p><p>I add burpsuite in the mid of the library requests to track it down and I noticed it calls <strong>different endpoints</strong>!</p><p><img loading=lazy src=https://miro.medium.com/v2/resize:fit:320/0*A4q6356PxRgZBIKH.gif></p><p>When using this endpoint, there is no XSS (Cross-Site Scripting) filter applied to functions that are intended to add links for the report writer. Below is an example of how this vulnerability can be exploited:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> utils_libs  
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> utils_libs.reports.v1 <span style=color:#66d9ef>as</span> ul
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Initialize the utils_libs API  </span>
</span></span><span style=display:flex><span>api <span style=color:#f92672>=</span> utils_libs<span style=color:#f92672>.</span>Api()<span style=color:#75715e># Define the entity and project  </span>
</span></span><span style=display:flex><span>entity <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;REPLACE&gt;&#34;</span>  <span style=color:#75715e># Replace with your utils_libs entity  </span>
</span></span><span style=display:flex><span>project <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;REPLACE&gt;&#34;</span>  <span style=color:#75715e># Replace with your utils_libs project# Create a new report  </span>
</span></span><span style=display:flex><span>report <span style=color:#f92672>=</span> ul<span style=color:#f92672>.</span>Report(  
</span></span><span style=display:flex><span>    entity<span style=color:#f92672>=</span>entity,  
</span></span><span style=display:flex><span>    project<span style=color:#f92672>=</span>project,  
</span></span><span style=display:flex><span>    title<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;XSS HERE - BE AWARE&#34;</span>,  
</span></span><span style=display:flex><span>    description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Never gonna give you up, never gonna let you down&#34;</span>  
</span></span><span style=display:flex><span>)<span style=color:#75715e># Add a block with an XSS payload  </span>
</span></span><span style=display:flex><span>report<span style=color:#f92672>.</span>blocks <span style=color:#f92672>=</span> [ul<span style=color:#f92672>.</span>Twitter(<span style=color:#e6db74>&#39;&#34;&gt;&lt;svg/onload=alert()&gt;&#39;</span>)]<span style=color:#75715e># Save the report  </span>
</span></span><span style=display:flex><span>report<span style=color:#f92672>.</span>save()
</span></span></code></pre></div><p>This code successfully stored an XSS payload, which can be accessed via the URL <code>example.ai/reports/&lt;reportid></code>. Notably, this report can be viewed by anyone, even if they are not part of my organization</p><p><img loading=lazy src=https://miro.medium.com/v2/resize:fit:480/0*XxPwaT6DwUAgyTLX.gif></p><h1 id=but-wait-theres-more>But wait, there’s more!<a hidden class=anchor aria-hidden=true href=#but-wait-theres-more>#</a></h1><p>After the excitement of the first payout wore off, I thought, “why not dig a bit deeper?”</p><p>Revisiting their repository, I found another interesting feature — embedding videos into reports. Now, embedding videos seemed innocent enough, but experience taught me never to underestimate innocent-looking functionalities.</p><p>So, I gave it a try:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>report <span style=color:#f92672>=</span> ul<span style=color:#f92672>.</span>Report(  
</span></span><span style=display:flex><span>    entity<span style=color:#f92672>=</span>entity,  
</span></span><span style=display:flex><span>    project<span style=color:#f92672>=</span>project,  
</span></span><span style=display:flex><span>    title<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Another Sneaky XSS&#34;</span>,  
</span></span><span style=display:flex><span>    description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Keep calm and hack responsibly&#34;</span>  
</span></span><span style=display:flex><span>)  
</span></span><span style=display:flex><span>report<span style=color:#f92672>.</span>pages <span style=color:#f92672>=</span> [ul<span style=color:#f92672>.</span>Video(<span style=color:#e6db74>&#39;javascript:alert()&#39;</span>)]  
</span></span><span style=display:flex><span>report<span style=color:#f92672>.</span>save()
</span></span></code></pre></div><p>And bingo! Another stored XSS! But this wasn’t just any simple vulnerability — this time, it was even more impactful.</p><p>By chaining this XSS with another minor misconfiguration, I escalated it to <strong>full account takeover</strong>.</p><p>That meant I could completely control someone’s account just by tricking them into viewing my crafted report.</p><p><img loading=lazy src=https://miro.medium.com/v2/resize:fit:700/1*k2U5b8qynuKX3XRR7LOQOQ.png></p><p>The team this time higher the impact and higher the bounty which is a good win</p><p><img loading=lazy src=https://miro.medium.com/v2/resize:fit:480/0*9HkGy1bjg5R6HlE9.gif></p><h2 id=side-hint>Side Hint:<a hidden class=anchor aria-hidden=true href=#side-hint>#</a></h2><p>Always dig deeper into seemingly unrelated or forgotten resources. Old API docs, outdated Python SDKs, archived repositories, or forgotten JavaScript files might contain hidden parameters or endpoints. These endpoints often bypass filters or security checks because they aren’t actively maintained, potentially leading to undiscovered vulnerabilities.</p><p>And that’s it</p><p>Bye ..</p><p><img loading=lazy src=https://miro.medium.com/v2/resize:fit:379/0*-Pc5vZ1KCEfJFa0o.gif></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.mindpatch.net/tags/xss/>XSS</a></li><li><a href=https://www.mindpatch.net/tags/account-takeover/>Account Takeover</a></li><li><a href=https://www.mindpatch.net/tags/sdk/>SDK</a></li><li><a href=https://www.mindpatch.net/tags/bug-bounty/>Bug Bounty</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.mindpatch.net/>@MindPatch</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>